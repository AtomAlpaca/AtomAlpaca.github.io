<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blog</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tufte-css/1.8.0/tufte.min.css">
    <link rel="stylesheet" href="/assets/tufted.css">
    <link rel="stylesheet" href="/assets/custom.css">
  </head>
  <body>
    <header>
      <nav>
        <div><a href="/">Home</a><a href="/blog/">Blog</a><a href="/friends/">Friends</a><a href="/cv/">CV</a></div>
        <div></div>
        <div></div>
      </nav>
    </header>
    <article>
      <section>
        <p>发现我的 dp 方式和别人都不一样啊。当场决定发篇题解。</p>
        <p>首先考虑没有灰点怎么做。观察样例可以很轻易得出一个错误的解法：考虑一次删掉所有白/黑点，然后依次删掉剩下的所有联通块。</p>
        <p>但我们考虑这样一个 hack：</p>
        <p>image(“<a href="https://cdn.luogu.com.cn/upload/image_hosting/re5qp92x.png">https://cdn.luogu.com.cn/upload/image_hosting/re5qp92x.png</a>”)</p>
        <p>按照上述的做法我们至少需要删除至少四次，但实际上我们最少只需要三次就可以了。</p>
        <p>顺着这个 hack 往下想。我们最优的策略应该是钦定某一个点为根之后，将所有链按照颜色分层，一条链层数增加当且仅当一条边的两个点颜色不同。然后从深层到浅层依次删除，令最长的一条链最短时就能够使得答案最小。不难发现这时的根节点就是树的“直径”的中点，层数为 $ + 1$。</p>
        <p>然后考虑加入灰点。不难发现其实灰点可以视作白点和黑点的任意一种，我们只需要将 dp 求树直径的方法稍微改造一下即可。令 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 3.0932999999999997em; height: 0.683em;" viewBox="0 0 34.0263 7.513000000000001" width="34.0263pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#gC5B8331D666FC53CB510C63A8ACC4B6D" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-group"><g><g class="typst-text" transform="matrix(1 0 0 -1 5.39 10.23)"><use xlink:href="#gFA1C3074D60BC7F029F43D3866F4F571" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 10.5875 10.23)"><use xlink:href="#g7882BD81A517986C378FD1540888AC41" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 13.197799999999999 10.23)"><use xlink:href="#g32E5453CF9CAEA8D6B5EA530C68CDFF7" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 18.187399999999997 10.23)"><use xlink:href="#g7882BD81A517986C378FD1540888AC41" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 20.7977 10.23)"><use xlink:href="#gAAF7CFA0FD7D42D897D4E7CD4B7D99A5" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 25.179000000000002 10.23)"><use xlink:href="#g676897D472B737A401231AC037BCD948" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g><g class="typst-text" transform="matrix(1 0 0 -1 29.029 10.23)"><use xlink:href="#gF3E1B410E64C9602757C9078B9C2AB6D" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g></g></g><defs id="glyph"><symbol id="gC5B8331D666FC53CB510C63A8ACC4B6D" overflow="visible"><path d="M 0 0m 6.072 6.963 c 0 0.4840002 -0.47300005 0.7920003 -0.99000025 0.7920003 c -0.6819997 0 -1.1549997 -0.44000006 -1.4079998 -1.309 c -0.055000067 -0.19799995 -0.17600012 -0.7590003 -0.352 -1.6830001 h -0.71500015 c -0.24199986 0 -0.36299992 -0.011000156 -0.36299992 -0.2420001 c 0 -0.12099981 0.11000013 -0.17600012 0.34100008 -0.17600012 h 0.65999985 l -0.803 -4.257 c -0.12099981 -0.627 -0.23099995 -1.089 -0.32999992 -1.3970001 c -0.13199997 -0.40699995 -0.319 -0.61599994 -0.561 -0.61599994 c -0.16499996 0 -0.29700005 0.04399991 -0.41799998 0.12099993 c 0.352 0.055000067 0.528 0.26400006 0.528 0.61600006 c 0 0.28599995 -0.143 0.42899996 -0.44000006 0.42899996 c -0.37399995 0 -0.63799995 -0.32999998 -0.63799995 -0.70399994 c 0 -0.4840001 0.45100003 -0.79199994 0.968 -0.79199994 c 0.27499998 0 0.528 0.109999895 0.7370001 0.34099984 c 0.35199976 0.36300004 0.62699986 0.88 0.8249998 1.5730001 c 0.12100005 0.429 0.23099995 0.847 0.3080001 1.265 l 0.638 3.4209998 h 0.90199995 c 0.25299978 0 0.36299992 0.011000156 0.36299992 0.26400042 c 0 0.09899998 -0.11000013 0.1539998 -0.32999992 0.1539998 h -0.8470001 c 0.065999985 0.45099974 0.37400007 2.112 0.47300005 2.321 c 0.11000013 0.23099995 0.26399994 0.34100008 0.4619999 0.34100008 c 0.16499996 0 0.3080001 -0.04400015 0.42900038 -0.12100029 c -0.34100008 -0.07700014 -0.5170002 -0.2750001 -0.5170002 -0.6160002 c 0 -0.28599977 0.14300013 -0.4289999 0.44000006 -0.4289999 c 0.37400007 0 0.638 0.32999992 0.638 0.704 Z "/></symbol><symbol id="gFA1C3074D60BC7F029F43D3866F4F571" overflow="visible"><path d="M 0 0m 4.0348 3.3187 c -0.30030012 0 -0.35420012 -0.22329998 -0.42350006 -0.48510003 l -0.39269996 -1.5708001 c -0.06929994 -0.2849 -0.10780001 -0.43119997 -0.11549997 -0.4389 c -0.25410008 -0.4235 -0.55439997 -0.6314 -0.89320016 -0.6314 c -0.33109987 0 -0.49279988 0.20019999 -0.49279988 0.6006 c 0 0.28489995 0.13859999 0.7931 0.42349994 1.5245999 c 0.06929994 0.18480015 0.10780001 0.31570005 0.10780001 0.40040016 c 0 0.40039992 -0.3542 0.6775999 -0.7545999 0.6775999 c -0.3619001 0 -0.64680004 -0.18479991 -0.86240005 -0.55439997 c -0.1771 -0.30030012 -0.2695 -0.50819993 -0.2695 -0.6314001 c 0 -0.08469987 0.053900003 -0.1308999 0.16169998 -0.1308999 c 0.08469999 0 0.13859999 0.046200037 0.16170001 0.14630008 c 0.11549997 0.37730002 0.37730002 0.9008999 0.78540003 0.9008999 c 0.10780001 0 0.16170001 -0.0769999 0.16170001 -0.23869991 c 0 -0.10780001 -0.046200037 -0.26950002 -0.13859999 -0.4928 c -0.26950002 -0.6853001 -0.4081 -1.1781001 -0.4081 -1.4784 c 0 -0.6699 0.42349994 -0.9933 1.0934 -0.9933 c 0.14629984 0 0.29259992 0.0308 0.43120003 0.0924 c 0.27719998 0.12319999 0.30799985 0.16170001 0.53900003 0.385 c 0.092399836 -0.21559998 0.23099995 -0.35419998 0.42349982 -0.40809998 c 0.13860011 -0.0462 0.26180005 -0.069299996 0.3619001 -0.069299996 c 0.49279976 0 0.7469001 0.5698 0.8701 1.0472 c 0.0230999 0.08470005 0.030799866 0.13089997 0.030799866 0.13859993 c 0 0.08470011 -0.053899765 0.13090003 -0.16169977 0.13090003 c -0.03850031 0 -0.069300175 -0.0076999664 -0.092400074 -0.023100019 c -0.05390024 -0.092399955 -0.092400074 -0.16939998 -0.10010004 -0.23099995 c -0.1308999 -0.5313 -0.3080001 -0.7931 -0.5236001 -0.7931 c -0.14629984 0 -0.22329998 0.1155 -0.22329998 0.34649998 c 0 0.08470005 0.03850007 0.27720004 0.11549997 0.5852 l 0.16170025 0.6853 l 0.1770997 0.66989994 c 0.08470011 0.3311 0.1308999 0.5236001 0.1308999 0.56980014 c 0 0.1539998 -0.1308999 0.26950002 -0.2848997 0.26950002 Z "/></symbol><symbol id="g7882BD81A517986C378FD1540888AC41" overflow="visible"><path d="M 0 0m 1.3013 0.8855 c -0.2464 0 -0.43890005 -0.20020002 -0.43890005 -0.45430002 c 0 -0.26950002 0.18479997 -0.4697 0.44660002 -0.4697 c 0.10009992 0 0.1925 0.0308 0.26950002 0.0847 c -0.015400052 -0.5082 -0.20020008 -0.93939996 -0.5544001 -1.2859 c -0.03849995 -0.03850007 -0.06159997 -0.069300056 -0.06159997 -0.10780001 c 0 -0.092400074 0.046200037 -0.13859999 0.13090003 -0.13859999 c 0.053900003 0 0.13090003 0.06159997 0.2464 0.18479991 c 0.25409997 0.2772001 0.50049996 0.83930004 0.50049996 1.3398 c 0 0.4235 -0.15399992 0.847 -0.5389999 0.847 Z "/></symbol><symbol id="g32E5453CF9CAEA8D6B5EA530C68CDFF7" overflow="visible"><path d="M 0 0m 4.4891 2.8105 c 0 0.39269996 -0.40040016 0.5852001 -0.8162 0.5852001 c -0.34649992 0 -0.63139987 -0.16939998 -0.8469999 -0.50819993 c -0.18480015 0.33879995 -0.4928 0.50819993 -0.91630006 0.50819993 c -0.28490007 0 -0.5852001 -0.12319994 -0.8855001 -0.37730002 c -0.31569993 -0.26180005 -0.47739995 -0.53130007 -0.47739995 -0.80850005 c 0 -0.08469987 0.053900003 -0.1308999 0.15399998 -0.1308999 c 0.08469999 0 0.13859999 0.046200037 0.1771 0.14630008 c 0.13859999 0.41579986 0.5159 0.9008999 1.0087 0.9008999 c 0.28490007 0 0.42349994 -0.15400004 0.42349994 -0.46969986 c 0 -0.10010004 -0.053900003 -0.3619001 -0.15400004 -0.78540015 l -0.26179993 -1.0318 c -0.06929994 -0.29259998 -0.3542 -0.6468 -0.6853 -0.6468 c -0.13090003 0 -0.2464 0.023100004 -0.33879995 0.07699999 c 0.15399992 0.069300026 0.29259992 0.2387 0.29259992 0.4158 c 0 0.18480003 -0.14629996 0.31570005 -0.33109993 0.31570005 c -0.2618 0 -0.462 -0.23100007 -0.462 -0.49280006 c 0 -0.385 0.4081 -0.5852 0.82390004 -0.5852 c 0.3542 0 0.63909996 0.1694 0.8469999 0.5082 c 0.18480015 -0.3388 0.48510003 -0.5082 0.9086001 -0.5082 c 0.42350006 0 0.7623 0.1694 1.0241001 0.5082 c 0.22329974 0.30029997 0.33879972 0.53129995 0.33879972 0.6775999 c 0 0.08470011 -0.0461998 0.13090003 -0.14629984 0.13090003 c -0.08470011 0 -0.14629984 -0.053900003 -0.17709994 -0.15399992 c -0.13090014 -0.4081 -0.5236001 -0.89320004 -1.0087001 -0.89320004 c -0.28489995 0 -0.4311998 0.15400001 -0.4311998 0.462 c 0 0.11549997 0.1308999 0.69299996 0.39269996 1.7170999 c 0.1308999 0.50049996 0.36189985 0.75460005 0.7084 0.75460005 l 0.06929994 -0.0076999664 c 0.092400074 0 0.18479991 -0.0230999 0.26950002 -0.06159997 c -0.19250011 -0.08470011 -0.28489995 -0.22329998 -0.28489995 -0.42350006 c 0 -0.18479991 0.14629984 -0.31570005 0.3311 -0.31570005 c 0.2617998 0 0.45429993 0.23100019 0.45429993 0.4928 Z "/></symbol><symbol id="gAAF7CFA0FD7D42D897D4E7CD4B7D99A5" overflow="visible"><path d="M 0 0m 2.3331 5.1128 c -0.3311 -0.32340002 -0.8239001 -0.48510027 -1.4938002 -0.48510027 v -0.33879995 c 0.4543 0 0.81619996 0.069300175 1.0934 0.20020008 v -3.8346 c 0 -0.10010004 -0.0077000856 -0.16170001 -0.030800104 -0.1925 c -0.03849995 -0.08470002 -0.2694999 -0.13090003 -0.69299996 -0.13090003 h -0.3157 v -0.3311 l 1.3706 0.0308 l 1.3783002 -0.0308 v 0.3311 h -0.31570005 c -0.42350006 0 -0.6545 0.046200007 -0.70070004 0.13090003 c -0.015399933 0.030799985 -0.0230999 0.092399955 -0.0230999 0.1925 v 4.2118998 c 0 0.20790005 -0.030800104 0.24640036 -0.26950002 0.24640036 Z "/></symbol><symbol id="g676897D472B737A401231AC037BCD948" overflow="visible"><path d="M 0 0m 3.0415 5.6363997 l -2.6103 -7.2764997 c -0.0616 -0.16939998 0.023099989 -0.2464 0.1155 -0.27719998 c 0.092400014 -0.030799985 0.20789999 -0.030799985 0.26950002 0.13859999 l 2.6103 7.2688 c 0.06159997 0.16940022 -0.023100138 0.24639988 -0.11550021 0.27720022 c -0.08469987 0.030799866 -0.20789981 0.038499832 -0.26949978 -0.13090038 Z "/></symbol><symbol id="gF3E1B410E64C9602757C9078B9C2AB6D" overflow="visible"><path d="M 0 0m 0.9163 3.2648 c 0.24639994 0 0.43119997 0.18479991 0.43119997 0.43120003 c 0 0.27719998 -0.14629996 0.42350006 -0.43119997 0.43120003 c 0.16940004 0.36189985 0.5544 0.6545 1.0548999 0.6545 c 0.6775999 0 1.1242001 -0.50820017 1.1242001 -1.1858001 c 0 -0.36960006 -0.13090014 -0.7238002 -0.40040016 -1.0703001 c -0.1308999 -0.17709994 -0.23099995 -0.30029988 -0.30029988 -0.36960006 l -1.8249 -1.8094999 c -0.10010001 -0.092400014 -0.08470002 -0.1155 -0.08470002 -0.3465 h 3.1724 l 0.23869991 1.4476 h -0.32340002 c -0.053900003 -0.4081 -0.11549997 -0.64680004 -0.18479991 -0.7007 c -0.03850007 -0.023100019 -0.27719998 -0.03850001 -0.7314999 -0.03850001 h -1.3090001 c 0.5159 0.45429993 0.9933001 0.86239994 1.4476 1.2243 c 0.34649992 0.2694999 0.59290004 0.50820005 0.7469001 0.71609986 c 0.23099995 0.30030012 0.34649992 0.6160002 0.34649992 0.94710016 c 0 0.47739983 -0.18479991 0.8547001 -0.56209993 1.1318998 c -0.3311 0.25409985 -0.7469001 0.38500023 -1.2397001 0.38500023 c -0.42349994 0 -0.7853999 -0.12319994 -1.1011 -0.3696003 c -0.3311 -0.26949978 -0.50049996 -0.60829973 -0.50049996 -1.0240998 c 0 -0.26180005 0.19250003 -0.45429993 0.4312 -0.45429993 Z "/></symbol></defs></svg></span> 为节点 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.572em; height: 0.683em;" viewBox="0 0 6.292 7.513000000000001" width="6.292pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g204062D1DDC9E1D90FB28A3D7F9A7BE3" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g204062D1DDC9E1D90FB28A3D7F9A7BE3" overflow="visible"><path d="M 0 0m 5.973 1.584 c 0 0.09899998 -0.055000305 0.15400004 -0.17600012 0.15400004 c -0.09899998 0 -0.1539998 -0.07700002 -0.1869998 -0.23100007 c -0.055000305 -0.20899999 -0.11000013 -0.41799998 -0.18700027 -0.627 c -0.14300013 -0.451 -0.34100008 -0.682 -0.5829997 -0.682 c -0.19799995 0 -0.2970004 0.154 -0.2970004 0.46199995 c 0 0.18700004 0.07700014 0.561 0.22000027 1.1110001 l 0.29699993 1.166 c 0.09899998 0.3959999 0.1869998 0.671 0.25300026 1.0119998 l 0.065999985 0.29699993 c 0.021999836 0.07700014 0.032999992 0.13199997 0.032999992 0.16499996 c 0 0.22000027 -0.12100029 0.3300004 -0.3630004 0.3300004 c -0.24199963 0 -0.3959999 -0.13199997 -0.4619999 -0.40700006 l -0.8139999 -3.256 c -0.010999918 -0.032999992 -0.055000067 -0.109999955 -0.14300013 -0.24199998 c -0.17599988 -0.28599995 -0.6049998 -0.63799995 -1.0449998 -0.63799995 c -0.41799998 0 -0.6270001 0.286 -0.6270001 0.84699994 c 0 0.4510001 0.19799995 1.1769999 0.58299994 2.1890001 c 0.12100005 0.32999992 0.18700004 0.5610001 0.18700004 0.6930001 c 0 0.5499997 -0.385 0.93499994 -0.93499994 0.93499994 c -0.495 0 -0.88 -0.2750001 -1.155 -0.8249998 c -0.20900002 -0.42900014 -0.319 -0.7260003 -0.319 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.15400004 0 0.23099995 -0.10999966 0.23099995 -0.31899977 c 0 -0.16499996 -0.065999985 -0.3959999 -0.18699992 -0.7149999 c -0.41799998 -1.1110001 -0.627 -1.881 -0.627 -2.288 c 0 -0.84699994 0.528 -1.342 1.375 -1.342 c 0.47300005 0 0.90199995 0.22 1.2649999 0.671 c 0.15400004 -0.451 0.4840002 -0.671 0.99000025 -0.671 c 0.7589998 0 0.9899998 0.891 1.1659999 1.705 Z "/></symbol></defs></svg></span> 在颜色为 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.572em; height: 0.683em;" viewBox="0 0 6.292 7.513000000000001" width="6.292pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#gD8091845B0770766234E6F50AD7A3DEF" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="gD8091845B0770766234E6F50AD7A3DEF" overflow="visible"><path d="M 0 0m 5.797 4.103 c 0 0.50600004 -0.4949999 0.7589998 -1.0450001 0.7589998 c -0.47300005 0 -0.8469999 -0.25299978 -1.1329999 -0.7589998 c -0.23099995 0.50600004 -0.61599994 0.7589998 -1.177 0.7589998 c -0.5389999 0 -0.979 -0.25299978 -1.331 -0.74800014 c -0.29699993 -0.4289999 -0.45099998 -0.7479999 -0.45099998 -0.9569998 c 0 -0.09899998 0.055000007 -0.15400004 0.16500002 -0.15400004 c 0.09900004 0 0.16500002 0.055000067 0.18699998 0.15400004 c 0.20899999 0.638 0.671 1.3859997 1.4080001 1.3859997 c 0.36299992 0 0.5389998 -0.23099995 0.5389998 -0.6819997 c 0 -0.23100019 -0.19799995 -1.089 -0.58299994 -2.5630002 c -0.18700004 -0.737 -0.51699996 -1.1 -0.9899999 -1.1 c -0.15400004 0 -0.29700005 0.033000007 -0.41800004 0.088000014 c 0.28599995 0.109999985 0.42899996 0.30799997 0.42899996 0.594 c 0 0.286 -0.143 0.42900002 -0.43999994 0.42900002 c -0.36300004 0 -0.638 -0.30799997 -0.638 -0.671 c 0 -0.50600004 0.51699996 -0.759 1.056 -0.759 c 0.462 0 0.83599997 0.253 1.1329999 0.759 c 0.20900011 -0.50600004 0.605 -0.759 1.177 -0.759 c 0.5279999 0 0.96799994 0.253 1.3200002 0.74799997 c 0.29699993 0.42900002 0.45099974 0.748 0.45099974 0.957 c 0 0.09899998 -0.05499983 0.15400004 -0.16499996 0.15400004 c -0.09899998 0 -0.1539998 -0.055000067 -0.1869998 -0.15400004 c -0.18700027 -0.627 -0.68200016 -1.386 -1.3970001 -1.386 c -0.36300015 0 -0.54999995 0.21999998 -0.54999995 0.671 c 0 0.14299995 0.05499983 0.45099992 0.17599988 0.9459999 l 0.37400007 1.485 c 0.20899987 0.82500005 0.54999995 1.2429998 1.0340002 1.2429998 c 0.1539998 0 0.29699993 -0.032999992 0.41799974 -0.08799982 c -0.29699993 -0.09899998 -0.44000006 -0.29699993 -0.44000006 -0.59399986 c 0 -0.286 0.15400028 -0.42900014 0.4510002 -0.42900014 c 0.35199976 0 0.62699986 0.319 0.62699986 0.67100024 Z "/></symbol></defs></svg></span> 时的第一/二长链，其中第一、第二长链没有公共边。令 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.572em; height: 0.683em;" viewBox="0 0 6.292 7.513000000000001" width="6.292pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g204062D1DDC9E1D90FB28A3D7F9A7BE3" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g204062D1DDC9E1D90FB28A3D7F9A7BE3" overflow="visible"><path d="M 0 0m 5.973 1.584 c 0 0.09899998 -0.055000305 0.15400004 -0.17600012 0.15400004 c -0.09899998 0 -0.1539998 -0.07700002 -0.1869998 -0.23100007 c -0.055000305 -0.20899999 -0.11000013 -0.41799998 -0.18700027 -0.627 c -0.14300013 -0.451 -0.34100008 -0.682 -0.5829997 -0.682 c -0.19799995 0 -0.2970004 0.154 -0.2970004 0.46199995 c 0 0.18700004 0.07700014 0.561 0.22000027 1.1110001 l 0.29699993 1.166 c 0.09899998 0.3959999 0.1869998 0.671 0.25300026 1.0119998 l 0.065999985 0.29699993 c 0.021999836 0.07700014 0.032999992 0.13199997 0.032999992 0.16499996 c 0 0.22000027 -0.12100029 0.3300004 -0.3630004 0.3300004 c -0.24199963 0 -0.3959999 -0.13199997 -0.4619999 -0.40700006 l -0.8139999 -3.256 c -0.010999918 -0.032999992 -0.055000067 -0.109999955 -0.14300013 -0.24199998 c -0.17599988 -0.28599995 -0.6049998 -0.63799995 -1.0449998 -0.63799995 c -0.41799998 0 -0.6270001 0.286 -0.6270001 0.84699994 c 0 0.4510001 0.19799995 1.1769999 0.58299994 2.1890001 c 0.12100005 0.32999992 0.18700004 0.5610001 0.18700004 0.6930001 c 0 0.5499997 -0.385 0.93499994 -0.93499994 0.93499994 c -0.495 0 -0.88 -0.2750001 -1.155 -0.8249998 c -0.20900002 -0.42900014 -0.319 -0.7260003 -0.319 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.15400004 0 0.23099995 -0.10999966 0.23099995 -0.31899977 c 0 -0.16499996 -0.065999985 -0.3959999 -0.18699992 -0.7149999 c -0.41799998 -1.1110001 -0.627 -1.881 -0.627 -2.288 c 0 -0.84699994 0.528 -1.342 1.375 -1.342 c 0.47300005 0 0.90199995 0.22 1.2649999 0.671 c 0.15400004 -0.451 0.4840002 -0.671 0.99000025 -0.671 c 0.7589998 0 0.9899998 0.891 1.1659999 1.705 Z "/></symbol></defs></svg></span> 为树上 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.49600000000000005em; height: 0.683em;" viewBox="0 0 5.456 7.513000000000001" width="5.456pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" overflow="visible"><path d="M 0 0m 4.059 4.301 c 0 -0.0880003 0.09899998 -0.23099995 0.2750001 -0.4510002 c 0.17599964 -0.22000003 0.26399994 -0.4729998 0.26399994 -0.7589998 c 0 -0.319 -0.15400028 -0.85800004 -0.47300005 -1.6170001 c -0.23099995 -0.528 -0.75900006 -1.276 -1.408 -1.276 c -0.50600004 0 -0.75900006 0.297 -0.75900006 0.902 c 0 0.42900002 0.20900011 1.1880001 0.6270001 2.277 c 0.08800006 0.23099995 0.13199997 0.41799998 0.13199997 0.54999995 c 0 0.5499997 -0.37400007 0.93499994 -0.924 0.93499994 c -0.48399997 0 -0.86899996 -0.2750001 -1.144 -0.8249998 c -0.22 -0.4510002 -0.32999998 -0.7370002 -0.32999998 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.143 0 0.22000003 -0.09899998 0.22000003 -0.3079996 c 0 -0.17600012 -0.055000067 -0.41800022 -0.176 -0.7370002 c -0.40700006 -1.089 -0.61600006 -1.826 -0.61600006 -2.2329998 c 0 -0.561 0.18700004 -0.946 0.561 -1.155 c 0.29700005 -0.154 0.60500014 -0.231 0.92400014 -0.231 c 0.97899985 0 1.661 1.056 1.9469998 1.903 c 0.35200024 1.034 0.5279999 1.7930001 0.5279999 2.277 c 0 0.53900003 -0.17599964 0.803 -0.5169997 0.803 c -0.2750001 0 -0.572 -0.28599977 -0.572 -0.5609999 Z "/></symbol></defs></svg></span> 的父亲，当 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.572em; height: 0.683em;" viewBox="0 0 6.292 7.513000000000001" width="6.292pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g204062D1DDC9E1D90FB28A3D7F9A7BE3" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g204062D1DDC9E1D90FB28A3D7F9A7BE3" overflow="visible"><path d="M 0 0m 5.973 1.584 c 0 0.09899998 -0.055000305 0.15400004 -0.17600012 0.15400004 c -0.09899998 0 -0.1539998 -0.07700002 -0.1869998 -0.23100007 c -0.055000305 -0.20899999 -0.11000013 -0.41799998 -0.18700027 -0.627 c -0.14300013 -0.451 -0.34100008 -0.682 -0.5829997 -0.682 c -0.19799995 0 -0.2970004 0.154 -0.2970004 0.46199995 c 0 0.18700004 0.07700014 0.561 0.22000027 1.1110001 l 0.29699993 1.166 c 0.09899998 0.3959999 0.1869998 0.671 0.25300026 1.0119998 l 0.065999985 0.29699993 c 0.021999836 0.07700014 0.032999992 0.13199997 0.032999992 0.16499996 c 0 0.22000027 -0.12100029 0.3300004 -0.3630004 0.3300004 c -0.24199963 0 -0.3959999 -0.13199997 -0.4619999 -0.40700006 l -0.8139999 -3.256 c -0.010999918 -0.032999992 -0.055000067 -0.109999955 -0.14300013 -0.24199998 c -0.17599988 -0.28599995 -0.6049998 -0.63799995 -1.0449998 -0.63799995 c -0.41799998 0 -0.6270001 0.286 -0.6270001 0.84699994 c 0 0.4510001 0.19799995 1.1769999 0.58299994 2.1890001 c 0.12100005 0.32999992 0.18700004 0.5610001 0.18700004 0.6930001 c 0 0.5499997 -0.385 0.93499994 -0.93499994 0.93499994 c -0.495 0 -0.88 -0.2750001 -1.155 -0.8249998 c -0.20900002 -0.42900014 -0.319 -0.7260003 -0.319 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.15400004 0 0.23099995 -0.10999966 0.23099995 -0.31899977 c 0 -0.16499996 -0.065999985 -0.3959999 -0.18699992 -0.7149999 c -0.41799998 -1.1110001 -0.627 -1.881 -0.627 -2.288 c 0 -0.84699994 0.528 -1.342 1.375 -1.342 c 0.47300005 0 0.90199995 0.22 1.2649999 0.671 c 0.15400004 -0.451 0.4840002 -0.671 0.99000025 -0.671 c 0.7589998 0 0.9899998 0.891 1.1659999 1.705 Z "/></symbol></defs></svg></span> 是灰点时，分别视作黑/白点转移即可；当 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.49600000000000005em; height: 0.683em;" viewBox="0 0 5.456 7.513000000000001" width="5.456pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" overflow="visible"><path d="M 0 0m 4.059 4.301 c 0 -0.0880003 0.09899998 -0.23099995 0.2750001 -0.4510002 c 0.17599964 -0.22000003 0.26399994 -0.4729998 0.26399994 -0.7589998 c 0 -0.319 -0.15400028 -0.85800004 -0.47300005 -1.6170001 c -0.23099995 -0.528 -0.75900006 -1.276 -1.408 -1.276 c -0.50600004 0 -0.75900006 0.297 -0.75900006 0.902 c 0 0.42900002 0.20900011 1.1880001 0.6270001 2.277 c 0.08800006 0.23099995 0.13199997 0.41799998 0.13199997 0.54999995 c 0 0.5499997 -0.37400007 0.93499994 -0.924 0.93499994 c -0.48399997 0 -0.86899996 -0.2750001 -1.144 -0.8249998 c -0.22 -0.4510002 -0.32999998 -0.7370002 -0.32999998 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.143 0 0.22000003 -0.09899998 0.22000003 -0.3079996 c 0 -0.17600012 -0.055000067 -0.41800022 -0.176 -0.7370002 c -0.40700006 -1.089 -0.61600006 -1.826 -0.61600006 -2.2329998 c 0 -0.561 0.18700004 -0.946 0.561 -1.155 c 0.29700005 -0.154 0.60500014 -0.231 0.92400014 -0.231 c 0.97899985 0 1.661 1.056 1.9469998 1.903 c 0.35200024 1.034 0.5279999 1.7930001 0.5279999 2.277 c 0 0.53900003 -0.17599964 0.803 -0.5169997 0.803 c -0.2750001 0 -0.572 -0.28599977 -0.572 -0.5609999 Z "/></symbol></defs></svg></span> 是灰点时，用 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.49600000000000005em; height: 0.683em;" viewBox="0 0 5.456 7.513000000000001" width="5.456pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g28FCF2B8C1FC2D2D1AAEEA3E269A58D9" overflow="visible"><path d="M 0 0m 4.059 4.301 c 0 -0.0880003 0.09899998 -0.23099995 0.2750001 -0.4510002 c 0.17599964 -0.22000003 0.26399994 -0.4729998 0.26399994 -0.7589998 c 0 -0.319 -0.15400028 -0.85800004 -0.47300005 -1.6170001 c -0.23099995 -0.528 -0.75900006 -1.276 -1.408 -1.276 c -0.50600004 0 -0.75900006 0.297 -0.75900006 0.902 c 0 0.42900002 0.20900011 1.1880001 0.6270001 2.277 c 0.08800006 0.23099995 0.13199997 0.41799998 0.13199997 0.54999995 c 0 0.5499997 -0.37400007 0.93499994 -0.924 0.93499994 c -0.48399997 0 -0.86899996 -0.2750001 -1.144 -0.8249998 c -0.22 -0.4510002 -0.32999998 -0.7370002 -0.32999998 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.143 0 0.22000003 -0.09899998 0.22000003 -0.3079996 c 0 -0.17600012 -0.055000067 -0.41800022 -0.176 -0.7370002 c -0.40700006 -1.089 -0.61600006 -1.826 -0.61600006 -2.2329998 c 0 -0.561 0.18700004 -0.946 0.561 -1.155 c 0.29700005 -0.154 0.60500014 -0.231 0.92400014 -0.231 c 0.97899985 0 1.661 1.056 1.9469998 1.903 c 0.35200024 1.034 0.5279999 1.7930001 0.5279999 2.277 c 0 0.53900003 -0.17599964 0.803 -0.5169997 0.803 c -0.2750001 0 -0.572 -0.28599977 -0.572 -0.5609999 Z "/></symbol></defs></svg></span> 分别为黑/白点时的最小值更新 <span role="math"><svg class="typst-frame" style="overflow: visible; width: 0.572em; height: 0.683em;" viewBox="0 0 6.292 7.513000000000001" width="6.292pt" height="7.513000000000001pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:h5="http://www.w3.org/1999/xhtml"><g><g class="typst-text" transform="matrix(1 0 0 -1 0 7.513000000000001)"><use xlink:href="#g204062D1DDC9E1D90FB28A3D7F9A7BE3" x="0" y="0" fill="#000000" fill-rule="nonzero"/></g></g><defs id="glyph"><symbol id="g204062D1DDC9E1D90FB28A3D7F9A7BE3" overflow="visible"><path d="M 0 0m 5.973 1.584 c 0 0.09899998 -0.055000305 0.15400004 -0.17600012 0.15400004 c -0.09899998 0 -0.1539998 -0.07700002 -0.1869998 -0.23100007 c -0.055000305 -0.20899999 -0.11000013 -0.41799998 -0.18700027 -0.627 c -0.14300013 -0.451 -0.34100008 -0.682 -0.5829997 -0.682 c -0.19799995 0 -0.2970004 0.154 -0.2970004 0.46199995 c 0 0.18700004 0.07700014 0.561 0.22000027 1.1110001 l 0.29699993 1.166 c 0.09899998 0.3959999 0.1869998 0.671 0.25300026 1.0119998 l 0.065999985 0.29699993 c 0.021999836 0.07700014 0.032999992 0.13199997 0.032999992 0.16499996 c 0 0.22000027 -0.12100029 0.3300004 -0.3630004 0.3300004 c -0.24199963 0 -0.3959999 -0.13199997 -0.4619999 -0.40700006 l -0.8139999 -3.256 c -0.010999918 -0.032999992 -0.055000067 -0.109999955 -0.14300013 -0.24199998 c -0.17599988 -0.28599995 -0.6049998 -0.63799995 -1.0449998 -0.63799995 c -0.41799998 0 -0.6270001 0.286 -0.6270001 0.84699994 c 0 0.4510001 0.19799995 1.1769999 0.58299994 2.1890001 c 0.12100005 0.32999992 0.18700004 0.5610001 0.18700004 0.6930001 c 0 0.5499997 -0.385 0.93499994 -0.93499994 0.93499994 c -0.495 0 -0.88 -0.2750001 -1.155 -0.8249998 c -0.20900002 -0.42900014 -0.319 -0.7260003 -0.319 -0.8800001 c 0 -0.09899998 0.055000007 -0.15400004 0.176 -0.15400004 c 0.143 0 0.16499996 0.065999985 0.20899999 0.22000003 c 0.25300002 0.8800001 0.605 1.3199997 1.056 1.3199997 c 0.15400004 0 0.23099995 -0.10999966 0.23099995 -0.31899977 c 0 -0.16499996 -0.065999985 -0.3959999 -0.18699992 -0.7149999 c -0.41799998 -1.1110001 -0.627 -1.881 -0.627 -2.288 c 0 -0.84699994 0.528 -1.342 1.375 -1.342 c 0.47300005 0 0.90199995 0.22 1.2649999 0.671 c 0.15400004 -0.451 0.4840002 -0.671 0.99000025 -0.671 c 0.7589998 0 0.9899998 0.891 1.1659999 1.705 Z "/></symbol></defs></svg></span>，简单分讨一下即可。具体的实现方法不是很好描述，建议参考代码。</p>
        <pre><code>#include &lt;bits/stdc++.h><br><br>const int MAX = 2e5 + 5;<br><br>int T, n, tot, ans, u, v;<br>int h[MAX], a[MAX], f[MAX][3][3];<br>struct E { int v, x; } e[MAX &lt;&lt; 2];<br><br>void clear()<br>{<br>  tot = ans = 0;<br>  for (int i = 1; i &lt;= n; ++i) { h[i] = 0; f[i][1][1] = f[i][1][2] = f[i][2][1] = f[i][2][2] = 0; }<br>}<br><br>void add(int u, int v)<br>{<br>  e[++tot] = {v, h[u]}; h[u] = tot;<br>  e[++tot] = {u, h[v]}; h[v] = tot;<br>}<br><br>void work(int u, int x, int v)<br>{<br>  if (v > f[u][x][1]) { f[u][x][2] = f[u][x][1]; f[u][x][1] = v; }<br>  else if (v > f[u][x][2]) { f[u][x][2] = v; }<br>}<br><br>void dfs(int u, int fa)<br>{<br>  for (int i = h[u]; i; i = e[i].x)<br>  {<br>    int v = e[i].v; if (v == fa) { continue; } dfs(v, u);<br>    if (a[u])<br>    {<br>      if (a[v]) { work(u, a[u], f[v][a[v]][1] + (a[u] != a[v])); }<br>      else { work(u, a[u], std::min(f[v][1][1] + (a[u] != 1), f[v][2][1] + (a[u] != 2))); }<br>    }<br>    else<br>    {<br>      if (a[v])<br>      {<br>        work(u, 1, f[v][a[v]][1] + (a[v] != 1));<br>        work(u, 2, f[v][a[v]][1] + (a[v] != 2));<br>      }<br>      else<br>      {<br>        work(u, 1, std::min(f[v][1][1], f[v][2][1] + 1));<br>        work(u, 2, std::min(f[v][1][1] + 1, f[v][2][1]));<br>      }<br>    }<br>  }<br>}<br><br>void solve()<br>{<br>  scanf("%d", &amp;n);<br>  clear();<br>  for (int i = 1; i &lt;= n; ++i) { scanf("%d", &amp;a[i]); }<br>  for (int i = 1; i &lt;  n; ++i) { scanf("%d%d", &amp;u, &amp;v); add(u, v); }<br>  dfs(1, 0);<br>  for (int i = 1; i &lt;= n; ++i)<br>  {<br>    if (a[i]) { ans = std::max(ans, f[i][a[i]][1] + f[i][a[i]][2]); }<br>    else { ans = std::max(ans, std::min(f[i][1][1] + f[i][1][2], f[i][2][1] + f[i][2][2])); }<br>    }<br>  printf("%d\n", ((ans + 1) >> 1) + 1);<br>}<br><br>int main()<br>{<br>  scanf("%d", &amp;T); while (T--) { solve(); }<br>}</code></pre>
      </section>
    </article>
  </body>
</html>
